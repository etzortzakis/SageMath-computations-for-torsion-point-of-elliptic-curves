︠62770a26-3924-4395-9197-b7f58183a3ffs︠
K.<z> = CyclotomicField(5)
L.<w> = FunctionField(K)


b=w*(w^4 - 3*w^3 + 4*w^2 - 2*w + 1)/(w^4 + 2*w^3 + 4*w^2 + 3*w + 1)

E = EllipticCurve([b+1, b, b, 0, 0])
P5 = E([0,0])
Q5 = E([(w^4 - 3*w^3 + 4*w^2 - 2*w + 1)/((z^3+z^2 - 2)*(w -z - z^3)*(w - z^2 - z^4)),(w^4 - 3*w^3 + 4*w^2 - 2*w + 1)*(w-z-1)*(w-z^3-1)*(w-z^4-1)/((3 + z- z^2 - 3*z^3)*(w - z - z^3)^2*(w - z^2 - z^4)*(w - z^4 - z^3))])
5*Q5==E([0,1,0])


︡2d80699d-ef53-4561-a597-f77ea85adfe6︡{"stdout":"True"}︡{"stdout":"\n"}︡{"done":true}︡
︠aae9a2e0-f65c-401a-b5fb-94894516ebc7︠
︡ec4923cc-08cb-4c9a-ab01-66dcff3073f1︡
︠73ed5144-fd2b-4fad-b6b8-bc18735b7fb4s︠
#corrected
def act(A,B,C,D):
    P_p=A*P5+C*Q5
    Q_p=B*P5+D*Q5
    r=P_p[0];t=P_p[1]
    Q_dp=[Q_p[0]-r,Q_p[1]-t]
    b=w*(w^4 - 3*w^3 + 4*w^2 - 2*w + 1)/(w^4 + 2*w^3 + 4*w^2 + 3*w + 1)
    s=(2*r*b-t*(b+1)+3*r^2)/(b+r*(b+1)+2*t)
    b_p=E.a2()+2*s
    Q_tp=[Q_dp[0],Q_dp[1]-s*Q_dp[0]]
    F=E.change_weierstrass_model(1,r,s,t)
    b=F.a3()
    y = Q_tp[0]/b
    u = b*y/(y + 1)
    v = (y^2 + y - 1)/(u + 2*y + 3) + 1
    w_p = (y^2 + y - 1)/v - 2*y + 1
    t = (w_p^2 + w_p - 1)/((y + w_p + 1)*w_p)
    z_p = (Q_tp[1] * ((w_p^2 + w_p + t - 1)*(w_p^4 + 2*w_p^3 + 4*w_p^2 + 3*w_p + 1))
       /((w_p^4 - 3*w_p^3 + 4*w_p^2 - 2*w_p + 1)*(w_p^2 + (t - 4)*w_p + (4 - t)))
       + (2*w_p^3 + (3 - t)*w_p^2 + (4 - t)*w_p + (t - 1))/(5*t - 20))* (10*t - 35)/((w_p - t + 3)^2*(w_p + t - 2))
    print(w_p,z_p)
︡224f3d41-6fd8-4a33-9208-d4e468b8c8d0︡{"done":true}︡
︠fe1cbd10-e141-4e83-ae95-71f291bdd293s︠
act(1,0,0,2)
︡e44ced49-17fd-42a3-b9bf-24855ed786cb︡{"stdout":"(w, z^2)\n"}︡{"done":true}︡
︠53e10722-a45e-4def-81de-71878158c9b1s︠
act(1,1,0,1)
︡75ab0fef-be67-42a6-82da-d19ad54af9f7︡{"stdout":"(((9759345531463623046875*z^3 + 9759345531463623046875*z^2 - 6031607246398925781250)*w + 6031607246398925781250*z^2 + 9759345531463623046875*z + 6031607246398925781250)/((6031607246398925781250*z^2 + 9759345531463623046875*z + 6031607246398925781250)*w + 9759345531463623046875*z^3 + 15790952777862548828125*z^2 + 9759345531463623046875*z), z)"}︡{"stdout":"\n"}︡{"done":true}︡
︠52cb4cfd-5e34-4f99-98c5-440fe98f000es︠
act(1,2,0,1)
︡1f1336a0-6985-4697-9178-028eea088b02︡{"stdout":"(((6031607246398925781250*z^3 + 6031607246398925781250*z^2 - 3727738285064697265625)*w - 6031607246398925781250*z^3 + 9759345531463623046875*z + 9759345531463623046875)/((-6031607246398925781250*z^3 + 9759345531463623046875*z + 9759345531463623046875)*w + 6031607246398925781250*z^2 + 9759345531463623046875*z + 6031607246398925781250), z)"}︡{"stdout":"\n"}︡{"done":true}︡
︠5b4c5d7a-a300-48a0-a998-79921271efccs︠
act(1,3,0,1)
︡baae7de1-1cae-4338-80c2-ff98bcc05a60︡{"stdout":"(((6031607246398925781250*z^3 + 6031607246398925781250*z^2 - 3727738285064697265625)*w - 9759345531463623046875*z^3 - 15790952777862548828125*z^2 - 9759345531463623046875*z)/((-9759345531463623046875*z^3 - 15790952777862548828125*z^2 - 9759345531463623046875*z)*w - 3727738285064697265625*z^3 - 9759345531463623046875*z^2 - 9759345531463623046875*z - 3727738285064697265625), z)"}︡{"stdout":"\n"}︡{"done":true}︡
︠570ebdc3-67d0-4363-93e2-ca492d09a13as︠
act(1,4,0,1)
︡9cc7d04e-e5fd-4b42-b9c6-c0b32e5ae5d6︡{"stdout":"(((9759345531463623046875*z^3 + 9759345531463623046875*z^2 - 6031607246398925781250)*w - 3727738285064697265625*z^3 - 9759345531463623046875*z^2 - 9759345531463623046875*z - 3727738285064697265625)/((-3727738285064697265625*z^3 - 9759345531463623046875*z^2 - 9759345531463623046875*z - 3727738285064697265625)*w + 6031607246398925781250*z^3 - 9759345531463623046875*z - 9759345531463623046875), z)"}︡{"stdout":"\n"}︡{"done":true}︡
︠f240f703-cd56-4066-8866-2677e259e94c︠
︡b015af12-430a-472b-80ba-f2db70e9604e︡
︠d86e5d2a-0677-4530-9ab7-a2733ff66c94︠
#Ai=act(1,i,1,0)?

A1=((9759345531463623046875*z^3 + 9759345531463623046875*z^2 - 6031607246398925781250)*w + 6031607246398925781250*z^2 + 9759345531463623046875*z + 6031607246398925781250)/((6031607246398925781250*z^2 + 9759345531463623046875*z + 6031607246398925781250)*w + 9759345531463623046875*z^3 + 15790952777862548828125*z^2 + 9759345531463623046875*z)
A2=((6031607246398925781250*z^3 + 6031607246398925781250*z^2 - 3727738285064697265625)*w - 6031607246398925781250*z^3 + 9759345531463623046875*z + 9759345531463623046875)/((-6031607246398925781250*z^3 + 9759345531463623046875*z + 9759345531463623046875)*w + 6031607246398925781250*z^2 + 9759345531463623046875*z + 6031607246398925781250)
A3=((6031607246398925781250*z^3 + 6031607246398925781250*z^2 - 3727738285064697265625)*w - 9759345531463623046875*z^3 - 15790952777862548828125*z^2 - 9759345531463623046875*z)/((-9759345531463623046875*z^3 - 15790952777862548828125*z^2 - 9759345531463623046875*z)*w - 3727738285064697265625*z^3 - 9759345531463623046875*z^2 - 9759345531463623046875*z - 3727738285064697265625)
A4=((9759345531463623046875*z^3 + 9759345531463623046875*z^2 - 6031607246398925781250)*w - 3727738285064697265625*z^3 - 9759345531463623046875*z^2 - 9759345531463623046875*z - 3727738285064697265625)/((-3727738285064697265625*z^3 - 9759345531463623046875*z^2 - 9759345531463623046875*z - 3727738285064697265625)*w + 6031607246398925781250*z^3 - 9759345531463623046875*z - 9759345531463623046875)
A5=w
C=(-38740257601227410643884402023495085841954025892598656444221205674693919718265533447265625*z^3 - 38740257601227410643884402023495085841954025892598656444221205674693919718265533447265625*z^2 + 23942795930485009888432545176949678713247825928046863541709399214596487581729888916015625)
A=numerator(A1+A2+A3+A4+A5)/C
B=denominator(A1+A2+A3+A4+A5)/C
A/B==A1+A2+A3+A4+A5
A/B
︡3e6c9c35-8749-49c0-9287-3a8b00f860cb︡{"stdout":"True\n"}︡{"stdout":"(w^5 + 10*w^3 + 10*w^2 + 10*w + 3)/(w^4 + 2*w^3 + 4*w^2 + 3*w + 1)\n"}︡{"done":true}︡
︠443d6970-270f-45ac-b11a-6fc6a02c9b7f︠
︡8841b65d-e91e-4271-a90b-a7c74f84f2d7︡
︠dc592273-a0d3-477c-8875-ea2642969c52︠

︠fe7470b7-8884-40b8-a850-de47a095c6f9︠









